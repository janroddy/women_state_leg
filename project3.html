<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Percent women in U.S. State Legislatures</title>
		<script type="text/javascript" src="../d3.js"></script>
		<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
		<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>

		
		<style type="text/css">	
			.states {
    	stroke: #fff;
		  stroke-width:1px;
		}
		.states:hover{
		  stroke: #ff9933;
		  stroke-width:1px;
		}
		
		</style>

	</head>
	<body>
		<h2>Hypothesis: The percentage of women in U.S. state legislatures has increased since the general election in 2016.</h2>
		<h1>Women in State Leg</h1>



		<script type="text/javascript">

			//Width and height
			var w = 500;
			var h = 300;

			//Define map projection
			var projection = d3.geoAlbersUsa()
				.translate([w/2, h/2])
				.scale([500]);

			//Define path generator
			var path = d3.geoPath()
							 .projection(projection);
		/*	//old color scale				 
			//Define color and scale 
			var color = d3.scaleThreshold()
  				.domain([15, 20, 25, 30])
  				.range(d3.schemeBlues[5]);	
	
		*/
	//Define color and scale 
			var color = d3.scaleQuantize()
  				.domain([15, 20, 25, 30, 35, 40])
  				.range(d3.schemeBlues[7]);	

/*
  		var colorLegend = d3.legend.color()
        .labelFormat(d3.format(".0f"))
        .scale(color)
        .shapePadding(5)
        .shapeWidth(50)
        .shapeHeight(20)
        .labelOffset(12);

      svg.append("g")
        .attr("transform", "translate(352, 60)")
        .call(colorLegend);


*/



			//Create SVG element
			var svg = d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);

			//Load in data
			d3.csv("women_state_leg.csv", function(data) {
				for (var i = 0; i < data.length; i++) {
        console.log("state: " +data[i].state);
        console.log("value: " + data[i].value);

    }
				//Set input domain for color scale
				color.domain([
					d3.min(data, function(d) { return d.value; }), 
					d3.max(data, function(d) { return d.value; })
				]);











				//Load in GeoJSON data
				d3.json("us-states.json", function(json) {

					//Merge the legislature data and GeoJSON
					//Loop through once for each legislature data value
					for (var i = 0; i < data.length; i++) {
					//	console.log(data);
		
						//Grab state name
					//	console.log(data[i].state);
						var dataState = data[i].state;
					//	console.log(dataState);
	
						
						//Grab data value, and convert from string to float
						var dataValue = parseFloat(data[i].value);
				
						//Find the corresponding state inside the GeoJSON
						for (var j = 0; j < json.features.length; j++) {
						
							var jsonState = json.features[j].properties.name;
				
							if (dataState == jsonState) {
						
								//Copy the data value into the JSON
								json.features[j].properties.value = dataValue;
								
								//Stop looking through the JSON
								break;
								
							}
						}		
					}

					//Bind data and create one path per GeoJSON feature
					svg.selectAll("path")
				   .data(json.features)
				   .enter()
				   .append("path")
				   .attr('class', 'states')
				   .attr("d", path)
				//   .on('mouseover', tip.show)
      	//	 .on('mouseout', tip.hide)
				   .style("fill", function(d) {
					   		//Get data value
					   		var value = d.properties.value;
					   		
					   		if (value) {
					   			//If value exists…
						   		return color(value);
					   		} else {
					   			//If value is undefined…
						   		return "#ccc";
					   		}


					   });
			



				});
			
			});
			
		</script>

		<p>Data Source: <a href="http://www.ncsl.org/legislators-staff/legislators/womens-legislative-network.aspx">National Conference of State Legislatures</a>
 </p>




	</body>
</html>